<app-sidenav *ngIf="sidenav" (clickedOutside)="sidenav = !sidenav"></app-sidenav>

<div class="sticky pb-2" style="z-index: 1; background-color: white; ">
    <div class="d-flex justify-content-between">
        <div class="d-flex align-items-center">
            <fa-icon style="font-size: 25px;" (click)="sidenav = !sidenav" class="mr-3" icon=bars></fa-icon>
            <h2>Units</h2>
        </div>
        <!-- 
        <div class="d-flex align-items-center">
            <a [routerLink]="['/recipe/new']"><button class="btn btn-success ml-2">New Unit</button></a>
        </div> -->
    </div>
</div>



<accordion [isAnimated]="true">
    <accordion-group *ngFor="let type of unitTypes" [heading]="type.name">
        <div class="ml-4">
            <div class="mb-3">
                <strong>Base Unit:</strong>
                <span *ngFor="let unit of type.units | filter:'base_unit': true"> {{unit.name}}</span>
            </div>
            <ng-container *ngIf="(type.units | filter:'base_unit': false).length > 0; else noUnits">
                <table style="width: 100%;" class="table-bordered table-striped table-hover">
                    <thead>
                        <tr>
                            <th>Unit</th>
                            <th>Multiplier</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let unit of type.units | filter:'base_unit': false">
                            <td>{{unit.name}}</td>
                            <td>{{unit.multiplier}}</td>
                        </tr>
                    </tbody>
                </table>
            </ng-container>
            <ng-template #noUnits>
                <div class="text-danger">No Units</div>
            </ng-template>

            <button class=" btn btn-success btn-sm mt-3"
                (click)="unitTypeToAdd={name: type.name, type: type.id};openModal(template);">New {{type.name}}
                Unit</button>
        </div>
    </accordion-group>
</accordion>


<ng-template #template>
    <div class="modal-header">
        <h5 class="pull-left">Add {{unitTypeToAdd.name}} Unit</h5>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="d-flex align-items-center">
            <label for="name" style="min-width: 100px;">Name</label><input class="form-control" type="text" id="name">
        </div>
        <div class="d-flex align-items-center mt-2">
            <label for="multiplier" style="min-width: 100px;">Multiplier</label><input style="width: 85px;"
                class="form-control" type="number" id="multiplier">
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-success btn-sm" type="submit">Submit</button>
    </div>
</ng-template>